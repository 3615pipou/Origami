<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
html, body {
	margin: 0;
	overflow: hidden;
	height: 100%;
	text-align:center;
}
canvas[resize] {
	width: 100vmin;
	height: 100vmin;
}
</style>
<script type="text/javascript" src="../../src/graph.js"></script>
<script type="text/javascript" src="../../src/planarGraph.js"></script>
<script type="text/javascript" src="../../src/creasePattern.js"></script>
<script type="text/javascript" src="../../lib/paper-full.min.js"></script>
<script type="text/javascript" src="paperjscp.js"></script>
<script type="text/javascript" src="../../lib/d3.min.js"></script>
<script type="text/javascript">

var cp = new CreasePattern();
cp.birdBase();
console.log(cp);

window.onload = function() {
	var canvas = document.getElementById('canvas');
	paper.setup(canvas);
	zoomView(paper);
	var paperCP = new PaperCreasePattern(paper, cp);
	var nearestEdge = undefined;
	var nearestNode = undefined;

	var nodeCircle = new paper.Shape.Circle({
		center: [0, 0],
		radius: 0.03,
		fillColor: { hue:20, saturation:0.6, brightness:1 }//{ hue:130, saturation:0.8, brightness:0.7 }
	});

	paper.view.onFrame = function(event) { }
	paper.view.onResize = function(event) {
		zoomView(paper);
	}
	paper.view.onMouseMove = function(event) {
		mousePos = event.point;
		var nNode = cp.getNearestNode( mousePos.x, mousePos.y );
		var nEdge = cp.getNearestEdge( mousePos.x, mousePos.y ).edge;
		if(nearestNode != nNode){
			nearestNode = nNode;
			nodeCircle.position.x = cp.nodes[nearestNode].x;
			nodeCircle.position.y = cp.nodes[nearestNode].y;
			console.log("Node: " + nearestNode);
		}
		if(nearestEdge != nEdge){
			nearestEdge = nEdge;
			for(var i = 0; i < cp.edges.length; i++){
				var weight = 3;
				if(nearestEdge != undefined && nearestEdge == i){
					paperCP.edges[i].strokeWidth = paperCP.lineWeight*2;
				} else{
					paperCP.edges[i].strokeWidth = paperCP.lineWeight;
				}
			}
			console.log("Edge: " + nearestEdge);
		}
	}
	paper.view.onMouseDown = function(event){

	}
}

</script>
</head>
<body>
	<canvas id="canvas" resize></canvas>
</body>
</html>